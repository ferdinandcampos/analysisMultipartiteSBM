<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Structural analysis of ecological tripartite networks • analysisMultipartiteSBM</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Structural analysis of ecological tripartite networks">
<meta property="og:description" content="analysisMultipartiteSBM">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">analysisMultipartiteSBM</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Application_EcologicalNetworksDataset.html">Structural analysis of ecological tripartite networks</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/ferdinandcampos/analysisMultipartiteSBM/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="Application_EcologicalNetworksDataset_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Structural analysis of ecological tripartite networks</h1>
            <h3 class="subtitle">An application of methods to a new collection of ecological tripartite networks</h3>
                        <h4 class="author">Ferdinand Campos</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ferdinandcampos/analysisMultipartiteSBM/blob/master/vignettes/Application_EcologicalNetworksDataset.Rmd"><code>vignettes/Application_EcologicalNetworksDataset.Rmd</code></a></small>
      <div class="hidden name"><code>Application_EcologicalNetworksDataset.Rmd</code></div>

    </div>

    
    
<div id="preliminaries" class="section level2">
<h2 class="hasAnchor">
<a href="#preliminaries" class="anchor"></a>Preliminaries</h2>
<div id="requirements" class="section level3">
<h3 class="hasAnchor">
<a href="#requirements" class="anchor"></a>Requirements</h3>
<p>The packages required for the analysis are <strong>analysisMultipartiteSBM</strong> and some others for data manipulation or representation:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ferdinandcampos.github.io/analysisMultipartiteSBM">analysisMultipartiteSBM</a></span><span class="op">)</span></code></pre></div>
</div>
<div id="a-new-collection-of-networks" class="section level3">
<h3 class="hasAnchor">
<a href="#a-new-collection-of-networks" class="anchor"></a>A new collection of networks</h3>
<p>Notre étude est motivée par une nouvelle collection de 42 réseaux tripartites récemment rassemblée et préparée par Virginia Domínguez-García dans <span class="citation">Domínguez-García and Kéfi (<a href="#ref-dominguez2021notes" role="doc-biblioref">n.d.</a>)</span> à partir des principales études écologiques multipartites existant dans la littérature. Les réseaux collectés sont issus de zones géographiques - et donc de type d’espèces, climat, nature des sols - différentes compte tenu de la grande variété des pays d’origine des études sources (<span class="citation">Melián et al. (<a href="#ref-melian2009diversity" role="doc-biblioref">2009</a>)</span>, <span class="citation">Shinohara, Uchida, and Yoshida (<a href="#ref-shinohara2019contrasting" role="doc-biblioref">2019</a>)</span>, <span class="citation">Pocock, Evans, and Memmott (<a href="#ref-pocock2012robustness" role="doc-biblioref">2012</a>)</span>, <span class="citation">Hackett et al. (<a href="#ref-hackett2019reshaping" role="doc-biblioref">2019</a>)</span>, <span class="citation">Macfadyen et al. (<a href="#ref-macfadyen2009differences" role="doc-biblioref">2009</a>)</span> et <span class="citation">Dáttilo et al. (<a href="#ref-dattilo2016unravelling" role="doc-biblioref">2016</a>)</span>). Il s’agit néanmoins du premier jeu de réseaux écologiques multipartites réels unifiant différents travaux écologiques et le seul de cette ampleur. Les données comprennent 44 réseaux tripartites structurés comme ci-dessus, dont les deux interactions bipartites sont de trois natures différentes : mutualiste–antagoniste (MA), antagoniste–antagoniste (AA) et mutualiste–mutualiste (MM).</p>
<p>Les données utilisées sont les 17 réseaux de type mutualiste-antagoniste (MA) de ce jeu de données tripartites. Les interactions de ces 17 réseaux sont de deux types, herbivorie–pollinisation (i.e. a sont des herbivores, l des plantes et b des pollinisateurs) pour 16 d’entre eux et herbivorie–dispersion de graines (i.e. a sont des herbivores, l des plantes et b des espèces qui disséminent des graines) pour un d’entre eux. Par souci de clarté, on utilisera l’appellation commune d’espèces mutualistes pour l’ensemble des 17 réseaux.</p>
<p>Pour des questions de publication de données, le jeu de réseaux d’origine <span class="math inline">\(\texttt{ecologicalNetworksDataset}\)</span> (avant ou après calibration MBM) n’est pas rendu disponible ici. On peut néanmoins charger le résultat du calcul des métriques sur les blocs (voir plus bas).</p>
</div>
<div id="preparation-of-the-data" class="section level3">
<h3 class="hasAnchor">
<a href="#preparation-of-the-data" class="anchor"></a>Preparation of the data</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dataset_path</span><span class="op">=</span><span class="st">"data/ecologicalNetworksDataset/"</span>
<span class="va">dataset_names_MA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'Sinohara_1_ALL_PH'</span>, <span class="st">'Sinohara_2_ALL_PH'</span>, <span class="st">'Sinohara_3_ALL_PH'</span>, <span class="st">'Sinohara_4_ALL_PH'</span>, <span class="st">'Sinohara_ALL_A_PH'</span>, 
                      <span class="st">'Sinohara_ALL_E_PH'</span>, <span class="st">'Sinohara_ALL_I_PH'</span>, <span class="st">'Sinohara_2_E_PH'</span>, <span class="st">'Sinohara_3_E_PH'</span>, <span class="st">'Sinohara_4_I_PH'</span>, 
                      <span class="st">'Melian_OO_OO_PH'</span>, <span class="st">'Hackett_1_ALL_PH'</span>, <span class="st">'Hackett_2_ALL_PH'</span>, <span class="st">'Hackett_1_S_PH'</span>, <span class="st">'Hackett_1_GL_PH'</span>,
                      <span class="st">'Pocock_OO_OO_PH'</span>,<span class="st">'Melian_OO_OO_HSD'</span><span class="op">)</span>


<span class="va">dataset_names</span><span class="op">&lt;-</span><span class="va">dataset_names_MA</span>
<span class="va">Indices</span><span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">17</span></code></pre></div>
</div>
<div id="multipartite-block-model-mbm" class="section level3">
<h3 class="hasAnchor">
<a href="#multipartite-block-model-mbm" class="anchor"></a>Multipartite Block Model (MBM)</h3>
<p>Le modèle MBM introduit dans <span class="citation">Bar-Hen, Barbillon, and Donnet (<a href="#ref-Barhen2020" role="doc-biblioref">2020</a>)</span> étend pour des réseaux multipartites l’approche des modèles à blocs. C’est un modèle de mélange probabiliste qui généralise conjointement le célèbre  sur réseau simple et le , son extension aux réseaux bipartites. Il identifie des blocs d’espèces à l’intérieur des groupes d’espèces partageant des propriétés de connectivité similaires au sein de la collection de réseaux dans laquelle elles sont impliquées.</p>
<p>Pour tout couple de groupe d’espèces (GE) en interaction <span class="math inline">\((q,q^\prime)\in\mathcal E=\left\{(a,l),(b,l)\right\}\)</span> on définit la matrice <span class="math inline">\(X^{qq^\prime}\)</span> de sorte que pour tout couple d’espèces <span class="math inline">\((i,i^\prime)\in 1,\dots,n_q \times 1,\dots, n_{q^\prime}\)</span> des GE <span class="math inline">\(q\)</span> et <span class="math inline">\(q^\prime\)</span> respectivement :</p>
<p><span class="math display">\[
X^{qq^\prime}_{ii^\prime} = \left\{
    \begin{array}{ll}
        1 &amp; \mbox{si $i$ et $i^\prime$ sont en interaction,} \\ 
        0 &amp; \mbox{sinon.}
    \end{array}
\right.
\]</span></p>
<p>On suppose que chaque GE <span class="math inline">\(q\in\{a,l,b\}\)</span> est divisé en <span class="math inline">\(K_q\in\mathbb N^*\)</span>. Pour toute espèce <span class="math inline">\(i\in 1,\dots, n_q\)</span> de <span class="math inline">\(q\)</span>, soit <span class="math inline">\(Z_i^q\)</span> la variable latente de sorte que <span class="math inline">\(Z_i^q=k\)</span> si l’espèce <span class="math inline">\(i\)</span> du GE <span class="math inline">\(q\)</span> appartient au bloc <span class="math inline">\(k\in 1,\dots,K_q\)</span>. On suppose alors que :</p>
<p>Les <span class="math inline">\(Z_i^q\)</span> sont indépendantes et <span class="math inline">\(\forall q\in\{a,l,b\}, \forall k \in 1,\dots,K_q,  \forall i \in 1,\dots,n_q,\)</span> <span class="math display">\[
    \mathbb P(Z_{i}^q=k)=\pi_k^q \quad\quad\quad \textrm{avec} \quad\quad\quad
    \pi_k^q\in[0,1], \ \sum_{k=1}^{K_q}\pi_k^q=1,
\]</span> et puis <span class="math inline">\(\forall (q,q^\prime)\in\mathcal E,  \forall (k,k^\prime)\in\mathcal A^{qq^\prime},  \forall (i,i^\prime)\in\mathcal S^{qq^\prime},\)</span></p>
<p><span class="math display">\[
    X_{ii^\prime}^{qq^\prime}| \{Z_{i}^q=k, Z_{i^\prime}^{q^\prime}=k^\prime\} \sim_{ind}  \mathcal Bern(\alpha_{kk^\prime}^{qq^\prime}) \quad\quad\quad \textrm{avec} \quad\quad\quad \alpha_{kk^\prime}^{qq^\prime}\in [0,1].
\]</span></p>
<p>La quantité <span class="math inline">\(\theta_K=(\alpha,\pi)\)</span>, où <span class="math inline">\(\alpha=\left(\alpha_{kk^\prime}^{qq^\prime}\right)_{(k,k^\prime)\in\mathcal A^{qq^\prime}, (q,q^\prime)\in\mathcal E}\)</span> sont les probabilités de connexion entre blocs et <span class="math inline">\(\pi=\left(\pi_k^q\right)_{k\in 1,\dots,K_q, q\in\{a,l,b\}}\)</span> les tailles relatives des blocs, donne les paramètres inconnus du modèle à estimer à <span class="math inline">\(K=(K_a,K_l,K_b)\)</span> fixé. Le vecteur des nombres de blocs <span class="math inline">\(K\)</span> est aussi à déterminer.</p>
</div>
<div id="calibrate-mbm-and-compute-metrics" class="section level3">
<h3 class="hasAnchor">
<a href="#calibrate-mbm-and-compute-metrics" class="anchor"></a>Calibrate MBM and compute metrics</h3>
<p>Pour chaque réseau tripartite individuel, on calibre MBM et puis on s’intéresse aux blocs inférés dans les trois groupes d’espèces (GE). On fait le choix des 5 métriques suivantes pour classifier les blocs du groupe des connecteurs <span class="math inline">\(l\)</span>, définies pour chaque bloc <span class="math inline">\(k^\prime\in1,\dots,K_l\)</span> d’un groupe de connecteurs <span class="math inline">\(l\)</span> donné : <span class="math display">\[\left(\bar{c}_a, \bar{c}_b, \textrm{PR}_b^{sym}, \bar{c}_a^{\textrm{N}}, \bar{c}_b^{\textrm{N}}\right).\]</span> On peut calculer les valeurs de métriques sur les blocs des <span class="math inline">\(17\)</span> réseaux grâce aux commandes suivantes.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">analyseENetDataset</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/analysisTripartiteSBM.html">analysisTripartiteSBM</a></span><span class="op">(</span><span class="va">dataset_path</span>,<span class="va">dataset_names</span>,<span class="va">Indices</span>,quiet<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p>On peut aussi directement charger depuis le package la table <span class="math inline">\(\texttt{analyseENetDataset}\)</span> contenant ces valeurs.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">analyseEcologicalNetworksDataset</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">analyseENetDataset</span><span class="op">)</span>
<span class="co">#&gt; 'data.frame':    102 obs. of  21 variables:</span>
<span class="co">#&gt;  $ network_id     : num  1 1 1 1 1 2 2 2 2 2 ...</span>
<span class="co">#&gt;  $ network_name   : chr  "Sinohara_1_ALL_PH" "Sinohara_1_ALL_PH" "Sinohara_1_ALL_PH" "Sinohara_1_ALL_PH" ...</span>
<span class="co">#&gt;  $ nb_nodes       : num  91 91 91 91 91 108 108 108 108 108 ...</span>
<span class="co">#&gt;  $ nb_nodes_plants: num  42 42 42 42 42 41 41 41 41 41 ...</span>
<span class="co">#&gt;  $ nb_nodes_polli : num  23 23 23 23 23 28 28 28 28 28 ...</span>
<span class="co">#&gt;  $ nb_nodes_herbi : num  26 26 26 26 26 39 39 39 39 39 ...</span>
<span class="co">#&gt;  $ nb_plants_clust: num  2 2 2 2 2 3 3 3 3 3 ...</span>
<span class="co">#&gt;  $ nb_polli_clust : num  2 2 2 2 2 2 2 2 2 2 ...</span>
<span class="co">#&gt;  $ nb_herbi_clust : num  1 1 1 1 1 1 1 1 1 1 ...</span>
<span class="co">#&gt;  $ FG             : chr  "plants" "plants" "pollination" "pollination" ...</span>
<span class="co">#&gt;  $ cluster_id     : chr  "1" "2" "1" "2" ...</span>
<span class="co">#&gt;  $ cluster_pi     : num  0.4762 0.5238 0.0435 0.9565 1 ...</span>
<span class="co">#&gt;  $ c_inter1       : num  0.2652 -0.2411 1.5157 -0.0689 NA ...</span>
<span class="co">#&gt;  $ c_inter2       : num  -0.1 0.0909 NA NA 0 ...</span>
<span class="co">#&gt;  $ c_tot          : num  0.0714 -0.0649 1.5157 -0.0689 0 ...</span>
<span class="co">#&gt;  $ c_tot_sym      : num  0.0826 -0.0751 1.5157 -0.0689 0 ...</span>
<span class="co">#&gt;  $ PR_inter1      : num  0.87 0.158 NA NA NA ...</span>
<span class="co">#&gt;  $ PR_inter1_sym  : num  0.883 0.175 NA NA NA ...</span>
<span class="co">#&gt;  $ cKnn_inter1    : num  0.0272 -0.304 0.0322 -0.0122 NA ...</span>
<span class="co">#&gt;  $ cKnn_inter2    : num  0 0 NA NA 0 0 0 0 NA NA ...</span>
<span class="co">#&gt;  $ cKnn_tot       : num  0.0043 -0.048 0.0322 -0.0122 0 ...</span></code></pre></div>
</div>
</div>
<div id="caracterisation-of-the-ecological-structure" class="section level2">
<h2 class="hasAnchor">
<a href="#caracterisation-of-the-ecological-structure" class="anchor"></a>Caracterisation of the ecological structure</h2>
<div id="blocks-analysis" class="section level3">
<h3 class="hasAnchor">
<a href="#blocks-analysis" class="anchor"></a>Blocks analysis</h3>
<p>Les données issues des réseaux représentent <span class="math inline">\(N=53\)</span> blocs <span class="math inline">\(k^\prime\)</span> de plantes à classifier, en interactions avec <span class="math inline">\(21\)</span> blocs d’herbivores et <span class="math inline">\(28\)</span> blocs de mutualistes.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plotAnalysisTripartiteSBM.html">plotAnalysisTripartiteSBM</a></span><span class="op">(</span><span class="va">analyseENetDataset</span>,new.window<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p><img src="Application_EcologicalNetworksDataset_files/figure-html/plot%20block%20analysis-1.png" width="816"></p>
</div>
<div id="preparation-of-caracterisation" class="section level3">
<h3 class="hasAnchor">
<a href="#preparation-of-caracterisation" class="anchor"></a>Preparation of caracterisation</h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">FG</span><span class="op">=</span><span class="st">"plants"</span>
<span class="va">analysePlants</span><span class="op">&lt;-</span><span class="va">analyseENetDataset</span><span class="op">[</span><span class="va">analyseENetDataset</span><span class="op">$</span><span class="va">FG</span><span class="op">==</span><span class="va">FG</span>,<span class="op">]</span>
<span class="va">metrics</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"c_inter1"</span>,<span class="st">"c_inter2"</span>,<span class="st">"PR_inter1_sym"</span>,<span class="st">"cKnn_inter1"</span>,<span class="st">"cKnn_inter2"</span><span class="op">)</span>
<span class="va">order_clusters</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">2</span>,<span class="fl">5</span>,<span class="fl">4</span>,<span class="fl">6</span><span class="op">)</span>
<span class="va">nb_clusters</span><span class="op">&lt;-</span><span class="fl">6</span>
<span class="va">plotIndicesblocs</span><span class="op">&lt;-</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">analysePlants</span><span class="op">)</span></code></pre></div>
</div>
<div id="clustering-analysis-to-caracterise-blocks-of-plants" class="section level3">
<h3 class="hasAnchor">
<a href="#clustering-analysis-to-caracterise-blocks-of-plants" class="anchor"></a>Clustering analysis to caracterise blocks of plants</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">caracterisation</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/caracTripartiteSBM.html">caracTripartiteSBM</a></span><span class="op">(</span><span class="va">analysePlants</span>,<span class="va">metrics</span>,<span class="va">nb_clusters</span><span class="op">)</span>

<span class="va">caracterisation</span><span class="op">$</span><span class="va">centers</span>
<span class="co">#&gt;     c_inter1   c_inter2 PR_inter1_sym cKnn_inter1 cKnn_inter2</span>
<span class="co">#&gt; 1  0.1113756 -0.6085195     0.8597163   0.1548651  0.11727960</span>
<span class="co">#&gt; 2 -0.5582043  0.2885937    -0.9192510  -0.7329250  0.04028911</span>
<span class="co">#&gt; 3  2.8457136  1.0367753     0.7689613  -0.6906359  0.07255068</span>
<span class="co">#&gt; 4  0.8952272  4.6687678    -0.4288273  -0.4471173  0.10890542</span>
<span class="co">#&gt; 5 -0.5561838  0.2160028    -1.1429030   2.0279819  0.33243244</span>
<span class="co">#&gt; 6 -0.2826292 -1.4540790     0.3644965   0.4030125 -8.18743083</span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plotCaracTripartiteSBM.html">plotCaracTripartiteSBM</a></span><span class="op">(</span><span class="va">caracterisation</span>,new.window<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p><img src="Application_EcologicalNetworksDataset_files/figure-html/plot%20block%20caracterisation-1.png" width="816"></p>
</div>
</div>
<div id="additionnal-analyses" class="section level2">
<h2 class="hasAnchor">
<a href="#additionnal-analyses" class="anchor"></a>Additionnal analyses</h2>
<div id="appendix-1-functional-cartography" class="section level3">
<h3 class="hasAnchor">
<a href="#appendix-1-functional-cartography" class="anchor"></a>Appendix 1 : functional cartography</h3>
<p>Une façon d’illustrer les connectances partielles et taux de participation réside dans l’outil de la cartographie fonctionnelle (<span class="math inline">\(\textit{functional cartography}\)</span>) introduite en écologie dans le célèbre <span class="citation">Guimerà and Amaral (<a href="#ref-Guimera2005A" role="doc-biblioref">2005</a>)</span>, qui trace et classe des espèces dans un plan du type <span class="math inline">\((\textit{taux de participation}, \textit{degré})\)</span>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plotFunctionalCartography.html">plotFunctionalCartography</a></span><span class="op">(</span><span class="va">analyseENetDataset</span>,new.window<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p><img src="Application_EcologicalNetworksDataset_files/figure-html/plot%20functional%20cartography-1.png" width="576"></p>
</div>
<div id="appendix-2-degree-degree-of-neighbors-inversion" class="section level3">
<h3 class="hasAnchor">
<a href="#appendix-2-degree-degree-of-neighbors-inversion" class="anchor"></a>Appendix 2 :degree-degree of neighbors inversion</h3>
<p>Dans les écosystèmes plantes–pollinisateurs, une inversion en moyenne du caractère spécialiste/généraliste entre les espèces et leurs voisins est reportée dans la littérature (<span class="citation">Bascompte et al. (<a href="#ref-bascompte2003nested" role="doc-biblioref">2003</a>)</span>, <span class="citation">Jordano (<a href="#ref-jordano1987patterns" role="doc-biblioref">1987</a>)</span>). Ici on propose de retrouver ce signal à l’échelle des blocs en traçant pour les plantes et les pollinisateurs les courbes de connectances partielles <span class="math inline">\(\bar c_b\)</span> en fonction des connectances partielles moyennes des voisins <span class="math inline">\(\bar c_b^{\textrm{N}}\)</span> associées aux blocs des 16 réseaux de type herbivorie–pollinisation à l’étude.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Indices_plantspollination</span><span class="op">&lt;-</span><span class="va">Indices</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">8</span>,<span class="fl">11</span>,<span class="fl">13</span>,<span class="fl">14</span>,<span class="fl">15</span>,<span class="fl">17</span><span class="op">)</span><span class="op">]</span>
<span class="fu"><a href="../reference/plotDegInversion.html">plotDegInversion</a></span><span class="op">(</span><span class="va">analyseENetDataset</span>,<span class="va">Indices_plantspollination</span>,new.window<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p><img src="Application_EcologicalNetworksDataset_files/figure-html/plot%20deg%20inversion-1.png" width="816"></p>
</div>
<div id="additional-materials" class="section level3">
<h3 class="hasAnchor">
<a href="#additional-materials" class="anchor"></a>Additional materials</h3>
<p>One can plot the individual blocks’ distributions in clusters, per network.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#plotCaracTripartiteSBM(caracterisation,plot.type="distrib.networks",new.window=FALSE)</span></code></pre></div>
<p>The Multidimensional Scaling (MDS) can also be plotted.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#plotCaracTripartiteSBM(caracterisation,plot.type="mds",new.window=FALSE)</span></code></pre></div>
</div>
<div id="second-application-caracterisation-with-insects-only" class="section level3">
<h3 class="hasAnchor">
<a href="#second-application-caracterisation-with-insects-only" class="anchor"></a>Second application : caracterisation with insects only</h3>
<p>On peut mener une analyse analogue en ne retenant que des insectes parmi les herbivores, en ajoutant ou changeant les assertions suivantes :</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#For our analysis 2 (insects only)</span>
<span class="va">dataset_names</span><span class="op">&lt;-</span><span class="va">dataset_names_MA</span>
<span class="va">dataset_names</span><span class="op">[</span><span class="fl">16</span><span class="op">]</span><span class="op">&lt;-</span><span class="st">"PocockInsects_OO_OO_PH"</span>
<span class="va">Indices</span><span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">17</span>
<span class="va">Indices</span><span class="op">&lt;-</span><span class="va">Indices</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">11</span>,<span class="fl">17</span><span class="op">)</span><span class="op">]</span>

<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">analyseEcologicalNetworksDataset_insects</span><span class="op">)</span>

<span class="va">analysePlants</span><span class="op">&lt;-</span><span class="va">analyseENetDataset_insects</span><span class="op">[</span><span class="va">analyseENetDataset_insects</span><span class="op">$</span><span class="va">FG</span><span class="op">==</span><span class="va">FG</span>,<span class="op">]</span>
<span class="va">metrics</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"c_inter1"</span>,<span class="st">"c_inter2"</span>,<span class="st">"PR_inter1_sym"</span>,<span class="st">"cKnn_inter1"</span><span class="op">)</span>
<span class="va">order_clusters</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">5</span>,<span class="fl">4</span><span class="op">)</span>
<span class="va">nb_clusters</span><span class="op">&lt;-</span><span class="fl">5</span>
<span class="va">plotIndicesblocs</span><span class="op">&lt;-</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">analysePlants</span><span class="op">)</span>
<span class="va">plotIndicesblocs</span><span class="op">&lt;-</span><span class="va">plotIndicesblocs</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">27</span>,<span class="fl">28</span>,<span class="fl">29</span>,<span class="fl">30</span><span class="op">)</span><span class="op">]</span> <span class="co">#on enl?ve les 4 indices propres au r?seau 11 removed</span>
<span class="va">last_indice_blocs</span><span class="op">&lt;-</span><span class="va">plotIndicesblocs</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">plotIndicesblocs</span><span class="op">)</span><span class="op">]</span>
<span class="va">plotIndicesblocs</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">plotIndicesblocs</span>,<span class="va">last_indice_blocs</span><span class="op">+</span><span class="fl">1</span>,<span class="va">last_indice_blocs</span><span class="op">+</span><span class="fl">2</span>,<span class="va">last_indice_blocs</span><span class="op">+</span><span class="fl">3</span>,<span class="va">last_indice_blocs</span><span class="op">+</span><span class="fl">4</span><span class="op">)</span> <span class="co">#on ajoute 4 derniers num?ros</span>


<span class="fu"><a href="../reference/plotCaracTripartiteSBM.html">plotCaracTripartiteSBM</a></span><span class="op">(</span><span class="va">caracterisation</span>,<span class="va">plotIndicesblocs</span><span class="op">)</span></code></pre></div>
<hr>
<div id="refs" class="references">
<div id="ref-Barhen2020">
<p>Bar-Hen, Avner, Pierre Barbillon, and Sophie Donnet. 2020. “Block Models for Generalized Multipartite Networks: Applications in Ecology and Ethnobiology.” <em>Statistical Modelling</em>.</p>
</div>
<div id="ref-bascompte2003nested">
<p>Bascompte, Jordi, Pedro Jordano, Carlos J Melián, and Jens M Olesen. 2003. “The Nested Assembly of Plant–Animal Mutualistic Networks.” <em>Proceedings of the National Academy of Sciences</em> 100 (16): 9383–7.</p>
</div>
<div id="ref-dattilo2016unravelling">
<p>Dáttilo, Wesley, Nubia Lara-Rodrı́guez, Pedro Jordano, Paulo R Guimarães Jr, John N Thompson, Robert J Marquis, Lucas P Medeiros, Raul Ortiz-Pulido, Maria A Marcos-Garcı́a, and Victor Rico-Gray. 2016. “Unravelling Darwin’s Entangled Bank: Architecture and Robustness of Mutualistic Networks with Multiple Interaction Types.” <em>Proceedings of the Royal Society B: Biological Sciences</em> 283 (1843): 20161564.</p>
</div>
<div id="ref-dominguez2021notes">
<p>Domínguez-García, Virginia, and Sonia Kéfi. n.d. “The Structure and Robustness of Tripartite Ecological Networks.”</p>
</div>
<div id="ref-Guimera2005A">
<p>Guimerà, Roger, and Luı́s A. Nunes Amaral. 2005. “Functional Cartography of Complex Metabolic Networks.” <em>Nature</em> 433 (7028): 895–900. <a href="https://doi.org/10.1038/nature03288">https://doi.org/10.1038/nature03288</a>.</p>
</div>
<div id="ref-hackett2019reshaping">
<p>Hackett, Talya D, Alix MC Sauve, Nancy Davies, Daniel Montoya, Jason M Tylianakis, and Jane Memmott. 2019. “Reshaping Our Understanding of Species’ Roles in Landscape-Scale Networks.” <em>Ecology Letters</em> 22 (9): 1367–77.</p>
</div>
<div id="ref-jordano1987patterns">
<p>Jordano, Pedro. 1987. “Patterns of Mutualistic Interactions in Pollination and Seed Dispersal: Connectance, Dependence Asymmetries, and Coevolution.” <em>The American Naturalist</em> 129 (5): 657–77.</p>
</div>
<div id="ref-macfadyen2009differences">
<p>Macfadyen, Sarina, Rachel Gibson, Andrew Polaszek, Rebecca J Morris, Paul G Craze, Robert Planqué, William OC Symondson, and Jane Memmott. 2009. “Do Differences in Food Web Structure Between Organic and Conventional Farms Affect the Ecosystem Service of Pest Control?” <em>Ecology Letters</em> 12 (3): 229–38.</p>
</div>
<div id="ref-melian2009diversity">
<p>Melián, Carlos J, Jordi Bascompte, Pedro Jordano, and Vlastimil Krivan. 2009. “Diversity in a Complex Ecological Network with Two Interaction Types.” <em>Oikos</em> 118 (1): 122–30.</p>
</div>
<div id="ref-pocock2012robustness">
<p>Pocock, Michael JO, Darren M Evans, and Jane Memmott. 2012. “The Robustness and Restoration of a Network of Ecological Networks.” <em>Science</em> 335 (6071): 973–77.</p>
</div>
<div id="ref-shinohara2019contrasting">
<p>Shinohara, Naoto, Kei Uchida, and Takehito Yoshida. 2019. “Contrasting Effects of Land-Use Changes on Herbivory and Pollination Networks.” <em>Ecology and Evolution</em> 9 (23): 13585–95.</p>
</div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Ferdinand Campos.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
